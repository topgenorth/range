<html>
  <head>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Field type change</title>
    <link rel="stylesheet" type="text/css" href="../../../style.css">
  </head>
  <body>
    <div class="CommonContent">
      <div class="CommonContentArea">
        <h1>Field type change</h1><script>
//We attach this function to a browser object as a variable so that if multiple of these blocks are
//present on the same page, then they will simply over-write eachother with the same function instead
//of generating a naming collision.
window.WikiCodeFormattingCopyToClipboard = function copyToClipboard(sID){
	var sContent = document.getElementById(sID).innerText;
	if( window.clipboardData && clipboardData.setData )
	{
		clipboardData.setData("Text", sContent);
	}
	else
	{
		alert("You must enable javascript access to your clipboard for this feature to work. Please referr to your browser documentation or Google search for instructions.");
	}
}
</script> 

<P>The reviewed refactoring types are fairly easy. It gets more difficult when you need to change a field's type.</P>
<P>If you modify a field's type, db4o internally creates a new field of the same name, but with the new type. The values of the old typed field are still present, but hidden. If you will change the type back to the old type the old values will still be there. </P>
<P>You can access the values of the previous field data using StoredField API.</P>

<span name="cs_wiki_filter" csw_filters="cs">
<P>c#: </P>
<P><code>IStoredClass#StoredField(name, type) </code></P>
</span>
<span name="cs_wiki_filter" csw_filters="vb">
<P>VB: </P>
<P><code>IStoredClass#StoredField(name, type) </code></P>
</span>
<P>gives you access to the field, which type was changed.</P>

<span name="cs_wiki_filter" csw_filters="cs">
<P>c#: </P>
<P><code>IStoredField#Get(Object)</code></P>
</span>
<span name="cs_wiki_filter" csw_filters="vb">
<P>VB: </P>
<P><code>IStoredField#Get(Object)</code></P>
</span>
<P>allows you to get the old field value for the specified object.</P>
<P>To see how it works on example, let's change Pilot's field name from type string to type Identity:</P>

<span name="cs_wiki_filter" csw_filters="cs">
<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">Identity.cs</span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_0_67_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_0_67_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_0_67_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_0_67_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_0_67_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_0_67_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_0_67_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_0_67_Open_Text').style.display='inline';"/><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_0_67_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">/**/</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_0_67_Open_Text"><span style="color: #008000;">/*</span><span style="color: #008000;"> Copyright (C) 2004 - 2007 db4objects Inc. </span><span style="color: #008000; text-decoration: underline;">http://www.db4o.com</span><span style="color: #008000;"> </span><span style="color: #008000;">*/</span></span><span style="color: #000000;">
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/></span><span style="color: #0000FF;">namespace</span><span style="color: #000000;"> Db4objects.Db4odoc.Refactoring.NewClasses
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_120_480_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_120_480_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_120_480_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_120_480_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_120_480_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_120_480_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_120_480_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_120_480_Open_Text').style.display='inline';"/></span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_120_480_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_120_480_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>  </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> Identity
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_146_478_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_146_478_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_146_478_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_146_478_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_146_478_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_146_478_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_146_478_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_146_478_Open_Text').style.display='inline';"/>  </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_146_478_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_146_478_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">string</span><span style="color: #000000;">  _name;
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">string</span><span style="color: #000000;"> _id;
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>  
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> Identity(</span><span style="color: #0000FF;">string</span><span style="color: #000000;"> name, </span><span style="color: #0000FF;">string</span><span style="color: #000000;"> id)
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_241_276_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_241_276_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_241_276_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_241_276_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_241_276_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_241_276_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_241_276_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_241_276_Open_Text').style.display='inline';"/>    </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_241_276_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_241_276_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      _name </span><span style="color: #000000;">=</span><span style="color: #000000;"> name;
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      _id </span><span style="color: #000000;">=</span><span style="color: #000000;"> id;
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>  
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">string</span><span style="color: #000000;"> Name
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_302_377_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_302_377_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_302_377_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_302_377_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_302_377_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_302_377_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_302_377_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_302_377_Open_Text').style.display='inline';"/>    </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_302_377_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_302_377_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">get</span><span style="color: #000000;"> 
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_315_339_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_315_339_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_315_339_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_315_339_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_315_339_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_315_339_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_315_339_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_315_339_Open_Text').style.display='inline';"/>      </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_315_339_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_315_339_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> _name;
</span><span style="color: #008080;">20</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">21</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">set</span><span style="color: #000000;">
</span><span style="color: #008080;">22</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_350_373_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_350_373_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_350_373_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_350_373_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_350_373_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_350_373_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_350_373_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_350_373_Open_Text').style.display='inline';"/>      </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_350_373_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_350_373_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">23</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        _name</span><span style="color: #000000;">=</span><span style="color: #000000;">value;
</span><span style="color: #008080;">24</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">25</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">26</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>  
</span><span style="color: #008080;">27</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>  
</span><span style="color: #008080;">28</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">override</span><span style="color: #000000;"> </span><span style="color: #0000FF;">string</span><span style="color: #000000;"> ToString() 
</span><span style="color: #008080;">29</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_421_475_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_421_475_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_421_475_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_421_475_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_421_475_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_421_475_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_421_475_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_421_475_Open_Text').style.display='inline';"/>    </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_421_475_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesIdentity.Cs_NewclassesIdentity.Cs_1255_54_421_475_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">30</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> </span><span style="color: #0000FF;">string</span><span style="color: #000000;">.Format(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">{0}[{1}]</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, _name, _id);
</span><span style="color: #008080;">31</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">32</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>  }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">33</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>}</span></span></div></pre></div></div>
</span>
<span name="cs_wiki_filter" csw_filters="vb">
<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">Identity.vb</span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #008000;">'</span><span style="color: #008000;"> Copyright (C) 2004 - 2007 db4objects Inc. http://www.db4o.com </span><span style="color: #008000;">
</span><span style="color: #008080;">02</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/></span><span style="color: #0000FF;">Imports</span><span style="color: #000000;"> System
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/>
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_81_738_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_81_738_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_81_738_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_81_738_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_81_738_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_81_738_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_81_738_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_81_738_Open_Text').style.display='inline';"/></span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_81_738_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Namespace Db4objects</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_81_738_Open_Text"><span style="color: #0000FF;">Namespace</span><span style="color: #000000;"> Db4objects.Db4odoc.Refactoring.Newclasses
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_144_724_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_144_724_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_144_724_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_144_724_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_144_724_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_144_724_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_144_724_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_144_724_Open_Text').style.display='inline';"/>    </span><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_144_724_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Class Identity</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_144_724_Open_Text"><span style="color: #0000FF;">Class</span><span style="color: #000000;"> Identity
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #0000FF;">Private</span><span style="color: #000000;"> _name </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">String</span><span style="color: #000000;">
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #0000FF;">Private</span><span style="color: #000000;"> _id </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">String</span><span style="color: #000000;">
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_237_348_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_237_348_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_237_348_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_237_348_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_237_348_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_237_348_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_237_348_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_237_348_Open_Text').style.display='inline';"/>        </span><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_237_348_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub New()</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_237_348_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> </span><span style="color: #0000FF;">New</span><span style="color: #000000;">(</span><span style="color: #0000FF;">ByVal</span><span style="color: #000000;"> name </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">String</span><span style="color: #000000;">, </span><span style="color: #0000FF;">ByVal</span><span style="color: #000000;"> id </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">String</span><span style="color: #000000;">)
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            _name </span><span style="color: #000000;">=</span><span style="color: #000000;"> name
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            _id </span><span style="color: #000000;">=</span><span style="color: #000000;"> id
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span><span style="color: #000000;">
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_365_565_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_365_565_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_365_565_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_365_565_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_365_565_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_365_565_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_365_565_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_365_565_Open_Text').style.display='inline';"/>        </span><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_365_565_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Property Name()</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_365_565_Open_Text"><span style="color: #0000FF;">Property</span><span style="color: #000000;"> Name() </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">String</span><span style="color: #000000;">
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Get</span><span style="color: #000000;">
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Return</span><span style="color: #000000;"> _name
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Get</span><span style="color: #000000;">
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Set</span><span style="color: #000000;">(</span><span style="color: #0000FF;">ByVal</span><span style="color: #000000;"> Value </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">String</span><span style="color: #000000;">)
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                _name </span><span style="color: #000000;">=</span><span style="color: #000000;"> Value
</span><span style="color: #008080;">20</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Set</span><span style="color: #000000;">
</span><span style="color: #008080;">21</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Property</span></span><span style="color: #000000;">
</span><span style="color: #008080;">22</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">23</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">24</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_603_710_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_603_710_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_603_710_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_603_710_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_603_710_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_603_710_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_603_710_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_603_710_Open_Text').style.display='inline';"/>        </span><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Overloads</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Overrides</span><span style="color: #000000;"> </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_603_710_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Function ToString()</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesIdentity.Vb_NewclassesIdentity.Vb_1367_54_603_710_Open_Text"><span style="color: #0000FF;">Function</span><span style="color: #000000;"> ToString() </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">String</span><span style="color: #000000;">
</span><span style="color: #008080;">25</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Return</span><span style="color: #000000;"> </span><span style="color: #0000FF;">String</span><span style="color: #000000;">.Format(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">{0}[{1}]</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, _name, _id)
</span><span style="color: #008080;">26</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Function</span></span><span style="color: #000000;">
</span><span style="color: #008080;">27</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    </span><span style="color: #0000FF;">End Class</span></span><span style="color: #000000;">
</span><span style="color: #008080;">28</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/></span><span style="color: #0000FF;">End Namespace</span></span></div></pre></div></div>
</span>
<P>Now to access old "name" values and transfer them to the new "name" we can use the following procedure:</P>

<span name="cs_wiki_filter" csw_filters="cs">
<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">RefactoringExample.cs: <span class="fscMemberName">TransferValues</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> TransferValues()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_39_781_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_39_781_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_39_781_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_39_781_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_39_781_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_39_781_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_39_781_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_39_781_Open_Text').style.display='inline';"/>    </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_39_781_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_39_781_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      IObjectContainer container </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(Db4oFileName);
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">try</span><span style="color: #000000;"> 
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_120_731_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_120_731_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_120_731_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_120_731_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_120_731_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_120_731_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_120_731_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_120_731_Open_Text').style.display='inline';"/>      </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_120_731_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_120_731_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        IStoredClass sc </span><span style="color: #000000;">=</span><span style="color: #000000;"> container.Ext().StoredClass(</span><span style="color: #0000FF;">typeof</span><span style="color: #000000;">(Pilot));
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        System.Console.WriteLine(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Stored class:  </span><span style="color: #800000;">&quot;</span><span style="color: #000000;">+</span><span style="color: #000000;"> sc.ToString());
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        IStoredField sfOld </span><span style="color: #000000;">=</span><span style="color: #000000;"> sc.StoredField(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">_name</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">,</span><span style="color: #0000FF;">typeof</span><span style="color: #000000;">(</span><span style="color: #0000FF;">string</span><span style="color: #000000;">));
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        System.Console.WriteLine(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Old field:  </span><span style="color: #800000;">&quot;</span><span style="color: #000000;">+</span><span style="color: #000000;"> sfOld.ToString()</span><span style="color: #000000;">+</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">;</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">+</span><span style="color: #000000;">sfOld.GetStoredType());
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        IQuery q </span><span style="color: #000000;">=</span><span style="color: #000000;"> container.Query();
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        q.Constrain(</span><span style="color: #0000FF;">typeof</span><span style="color: #000000;">(Pilot));
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        IObjectSet result </span><span style="color: #000000;">=</span><span style="color: #000000;"> q.Execute();
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #0000FF;">foreach</span><span style="color: #000000;"> (</span><span style="color: #0000FF;">object</span><span style="color: #000000;"> obj </span><span style="color: #0000FF;">in</span><span style="color: #000000;"> result)
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_549_726_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_549_726_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_549_726_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_549_726_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_549_726_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_549_726_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_549_726_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_549_726_Open_Text').style.display='inline';"/>        </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_549_726_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_549_726_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          Pilot pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> (Pilot)obj;
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          pilot.Name </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Identity(sfOld.Get(pilot).ToString(),</span><span style="color: #800000;">&quot;&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          System.Console.WriteLine(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Pilot=</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">+</span><span style="color: #000000;"> pilot);
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          container.Set(pilot);
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>        }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">20</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;"> 
</span><span style="color: #008080;">21</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">finally</span><span style="color: #000000;"> 
</span><span style="color: #008080;">22</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_748_777_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_748_777_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_748_777_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_748_777_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_748_777_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_748_777_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_748_777_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_748_777_Open_Text').style.display='inline';"/>      </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_748_777_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsnewclassesRefactoringExample.Cs_NewclassesRefactoringExample.Cs_TransferValues_1593_79_748_777_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">23</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        container.Close();
</span><span style="color: #008080;">24</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">25</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div>
</span>
<P><span name="cs_wiki_filter" csw_filters="vb"></P>
<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">RefactoringExample.vb: <span class="fscMemberName">TransferValues</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesRefactoringExample.Vb_NewclassesRefactoringExample.Vb_TransferValues_1737_79"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesRefactoringExample.Vb_NewclassesRefactoringExample.Vb_TransferValues_1737_79_15_1082_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesRefactoringExample.Vb_NewclassesRefactoringExample.Vb_TransferValues_1737_79_15_1082_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesRefactoringExample.Vb_NewclassesRefactoringExample.Vb_TransferValues_1737_79_15_1082_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesRefactoringExample.Vb_NewclassesRefactoringExample.Vb_TransferValues_1737_79_15_1082_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesRefactoringExample.Vb_NewclassesRefactoringExample.Vb_TransferValues_1737_79_15_1082_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesRefactoringExample.Vb_NewclassesRefactoringExample.Vb_TransferValues_1737_79_15_1082_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesRefactoringExample.Vb_NewclassesRefactoringExample.Vb_TransferValues_1737_79_15_1082_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesRefactoringExample.Vb_NewclassesRefactoringExample.Vb_TransferValues_1737_79_15_1082_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesRefactoringExample.Vb_NewclassesRefactoringExample.Vb_TransferValues_1737_79_15_1082_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub TransferValues()</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsnewclassesRefactoringExample.Vb_NewclassesRefactoringExample.Vb_TransferValues_1737_79_15_1082_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> TransferValues()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> container </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectContainer </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(Db4oFileName)
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> sc </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IStoredClass </span><span style="color: #000000;">=</span><span style="color: #000000;"> container.Ext().StoredClass(</span><span style="color: #0000FF;">GetType</span><span style="color: #000000;">(Pilot))
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                System.Console.WriteLine(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Stored class:  </span><span style="color: #800000;">&quot;</span><span style="color: #000000;"> </span><span style="color: #000000;">+</span><span style="color: #000000;"> sc.GetName())
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> sfOld </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IStoredField </span><span style="color: #000000;">=</span><span style="color: #000000;"> sc.StoredField(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">_name</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #0000FF;">GetType</span><span style="color: #000000;">(</span><span style="color: #0000FF;">String</span><span style="color: #000000;">))
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                System.Console.WriteLine(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Old field:  </span><span style="color: #800000;">&quot;</span><span style="color: #000000;"> </span><span style="color: #000000;">+</span><span style="color: #000000;"> sfOld.GetName() </span><span style="color: #000000;">+</span><span style="color: #000000;"> </span><span style="color: #800000;">&quot;</span><span style="color: #800000;">;</span><span style="color: #800000;">&quot;</span><span style="color: #000000;"> </span><span style="color: #000000;">+</span><span style="color: #000000;"> sfOld.GetStoredType().GetName())
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> q </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IQuery </span><span style="color: #000000;">=</span><span style="color: #000000;"> container.Query()
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                q.Constrain(</span><span style="color: #0000FF;">GetType</span><span style="color: #000000;">(Pilot))
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> result </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectSet </span><span style="color: #000000;">=</span><span style="color: #000000;"> q.Execute()
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> obj </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Object</span><span style="color: #000000;">
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">For</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Each</span><span style="color: #000000;"> obj </span><span style="color: #0000FF;">In</span><span style="color: #000000;"> result
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                    </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> pilot </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> Pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">CType</span><span style="color: #000000;">(obj, Pilot)
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                    pilot.Name </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">New</span><span style="color: #000000;"> Identity(sfOld.Get(pilot).ToString(), </span><span style="color: #800000;">&quot;&quot;</span><span style="color: #000000;">)
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                    System.Console.WriteLine(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Pilot=</span><span style="color: #800000;">&quot;</span><span style="color: #000000;"> </span><span style="color: #000000;">+</span><span style="color: #000000;"> pilot.ToString())
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                    container.Set(pilot)
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Next</span><span style="color: #000000;">
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Finally</span><span style="color: #000000;">
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                container.Close()
</span><span style="color: #008080;">20</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">21</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div>
<P></span> </P>
<P>These are the basic refactoring types, which can help with any changes you will need to make. </P></div>
    </div>
    <div id="footer">
					This revision (9) was last Modified 2007-08-15T20:48:35 by Eric Falsken.
				</div>
  </body>
</html>
<html>
  <head>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Refactoring API</title>
    <link rel="stylesheet" type="text/css" href="../../../style.css">
  </head>
  <body>
    <div class="CommonContent">
      <div class="CommonContentArea">
        <h1>Refactoring API</h1><script>
//We attach this function to a browser object as a variable so that if multiple of these blocks are
//present on the same page, then they will simply over-write eachother with the same function instead
//of generating a naming collision.
window.WikiCodeFormattingCopyToClipboard = function copyToClipboard(sID){
	var sContent = document.getElementById(sID).innerText;
	if( window.clipboardData && clipboardData.setData )
	{
		clipboardData.setData("Text", sContent);
	}
	else
	{
		alert("You must enable javascript access to your clipboard for this feature to work. Please referr to your browser documentation or Google search for instructions.");
	}
}
</script>


<p>Db4o provides special API which can help you to move classes between packages (Java)/namespaces(.NET), rename classes or fields:</p>



<span name="cs_wiki_filter" csw_filters="cs">

<p>c#:<br>
<code>Db4oFactory.Configure().ObjectClass("package.class").Rename("newPackage.newClass") <br>
Db4oFactory.Configure().ObjectClass("package.class").ObjectField("oldField").Rename("newField")</code></p>
 
</span>

<span name="cs_wiki_filter" csw_filters="vb">

<p>VB:<br><code>Db4oFactory.Configure().ObjectClass("package.class").Rename("newPackage.newClass") <br>
Db4oFactory.Configure().ObjectClass("package.class").ObjectField("oldField").Rename("newField") </code></p>

</span>

<p>
The safe order of actions for rename calls is:</p>

<ol>
<li>Backup you database and aaplication </li>

<li>Close all open objectContainers if any </li>

<li>Rename classes or fields or copy classes to the new package/namespace in your application. (Do not remove old classes yet).</li>

<li>Issue ObjectClass#rename and objectField#rename calls without having an ObjectContainer open.</li>

<li>Open database file and close it again without actually working with it.</li>

<li>Remove old classes (if applicable).</li>
</ol>


<p>After that you will only see the new classes/fields in ObjectManager, the old ones will be gone.</p>

<p>Let's look how it works on an example. We will use initial class Pilot:</p>



<span name="cs_wiki_filter" csw_filters="cs">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">Pilot.cs</span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_0_67_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_0_67_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_0_67_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_0_67_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_0_67_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_0_67_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_0_67_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_0_67_Open_Text').style.display='inline';"/><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_0_67_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">/**/</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_0_67_Open_Text"><span style="color: #008000;">/*</span><span style="color: #008000;"> Copyright (C) 2004 - 2007 db4objects Inc. </span><span style="color: #008000; text-decoration: underline;">http://www.db4o.com</span><span style="color: #008000;"> </span><span style="color: #008000;">*/</span></span><span style="color: #000000;">
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/></span><span style="color: #0000FF;">namespace</span><span style="color: #000000;"> Db4objects.Db4odoc.Refactoring
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_109_388_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_109_388_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_109_388_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_109_388_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_109_388_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_109_388_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_109_388_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_109_388_Open_Text').style.display='inline';"/></span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_109_388_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_109_388_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>  </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> Pilot
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_132_386_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_132_386_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_132_386_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_132_386_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_132_386_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_132_386_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_132_386_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_132_386_Open_Text').style.display='inline';"/>  </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_132_386_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_132_386_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">string</span><span style="color: #000000;"> _name;
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> Pilot(</span><span style="color: #0000FF;">string</span><span style="color: #000000;"> name) 
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_192_217_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_192_217_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_192_217_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_192_217_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_192_217_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_192_217_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_192_217_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_192_217_Open_Text').style.display='inline';"/>    </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_192_217_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_192_217_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">this</span><span style="color: #000000;">._name</span><span style="color: #000000;">=</span><span style="color: #000000;">name;
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">string</span><span style="color: #000000;"> Name 
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_243_321_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_243_321_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_243_321_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_243_321_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_243_321_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_243_321_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_243_321_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_243_321_Open_Text').style.display='inline';"/>    </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_243_321_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_243_321_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">get</span><span style="color: #000000;"> 
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_256_280_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_256_280_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_256_280_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_256_280_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_256_280_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_256_280_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_256_280_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_256_280_Open_Text').style.display='inline';"/>      </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_256_280_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_256_280_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> _name;
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">set</span><span style="color: #000000;"> 
</span><span style="color: #008080;">20</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_292_317_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_292_317_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_292_317_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_292_317_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_292_317_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_292_317_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_292_317_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_292_317_Open_Text').style.display='inline';"/>      </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_292_317_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_292_317_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">21</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        _name </span><span style="color: #000000;">=</span><span style="color: #000000;"> value;
</span><span style="color: #008080;">22</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">23</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">24</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">override</span><span style="color: #000000;"> </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">string</span><span style="color: #000000;"> ToString() 
</span><span style="color: #008080;">25</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_361_383_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_361_383_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_361_383_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_361_383_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_361_383_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_361_383_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_361_383_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_361_383_Open_Text').style.display='inline';"/>    </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_361_383_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilot.Cs_Pilot.Cs_1494_40_361_383_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">26</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> _name;
</span><span style="color: #008080;">27</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">28</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>  }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">29</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>}</span></span></div></pre></div></div>

</span>

<span name="cs_wiki_filter" csw_filters="vb">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">Pilot.vb</span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #008000;">'</span><span style="color: #008000;"> Copyright (C) 2004 - 2007 db4objects Inc. http://www.db4o.com </span><span style="color: #008000;">
</span><span style="color: #008080;">02</span><span style="color: #008000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_65_596_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_65_596_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_65_596_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_65_596_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_65_596_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_65_596_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_65_596_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_65_596_Open_Text').style.display='inline';"/></span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_65_596_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Namespace Db4objects</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_65_596_Open_Text"><span style="color: #0000FF;">Namespace</span><span style="color: #000000;"> Db4objects.Db4odoc.Refactoring
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_117_582_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_117_582_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_117_582_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_117_582_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_117_582_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_117_582_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_117_582_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_117_582_Open_Text').style.display='inline';"/>    </span><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_117_582_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Class Pilot</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_117_582_Open_Text"><span style="color: #0000FF;">Class</span><span style="color: #000000;"> Pilot
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #0000FF;">Private</span><span style="color: #000000;"> _name </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">String</span><span style="color: #000000;">
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_177_250_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_177_250_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_177_250_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_177_250_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_177_250_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_177_250_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_177_250_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_177_250_Open_Text').style.display='inline';"/>        </span><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_177_250_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub New()</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_177_250_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> </span><span style="color: #0000FF;">New</span><span style="color: #000000;">(</span><span style="color: #0000FF;">ByVal</span><span style="color: #000000;"> name </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">String</span><span style="color: #000000;">)
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Me</span><span style="color: #000000;">._name </span><span style="color: #000000;">=</span><span style="color: #000000;"> name
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span><span style="color: #000000;">
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_267_467_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_267_467_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_267_467_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_267_467_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_267_467_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_267_467_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_267_467_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_267_467_Open_Text').style.display='inline';"/>        </span><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_267_467_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Property Name()</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_267_467_Open_Text"><span style="color: #0000FF;">Property</span><span style="color: #000000;"> Name() </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">String</span><span style="color: #000000;">
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Get</span><span style="color: #000000;">
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Return</span><span style="color: #000000;"> _name
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Get</span><span style="color: #000000;">
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Set</span><span style="color: #000000;">(</span><span style="color: #0000FF;">ByVal</span><span style="color: #000000;"> Value </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">String</span><span style="color: #000000;">)
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                _name </span><span style="color: #000000;">=</span><span style="color: #000000;"> Value
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Set</span><span style="color: #000000;">
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Property</span></span><span style="color: #000000;">
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_493_568_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_493_568_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_493_568_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_493_568_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_493_568_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_493_568_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_493_568_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_493_568_Open_Text').style.display='inline';"/>        </span><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Overrides</span><span style="color: #000000;"> </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_493_568_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Function ToString()</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilot.Vb_Pilot.Vb_1598_40_493_568_Open_Text"><span style="color: #0000FF;">Function</span><span style="color: #000000;"> ToString() </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">String</span><span style="color: #000000;">
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Return</span><span style="color: #000000;"> _name
</span><span style="color: #008080;">20</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Function</span></span><span style="color: #000000;">
</span><span style="color: #008080;">21</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    </span><span style="color: #0000FF;">End Class</span></span><span style="color: #000000;">
</span><span style="color: #008080;">22</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/></span><span style="color: #0000FF;">End Namespace</span></span></div></pre></div></div>

</span>

<p>and change it to the new class PilotNew renaming field and changing package/namespace at the same time:</p>



<span name="cs_wiki_filter" csw_filters="cs">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">PilotNew.cs</span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_0_67_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_0_67_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_0_67_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_0_67_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_0_67_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_0_67_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_0_67_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_0_67_Open_Text').style.display='inline';"/><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_0_67_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">/**/</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_0_67_Open_Text"><span style="color: #008000;">/*</span><span style="color: #008000;"> Copyright (C) 2004 - 2007 db4objects Inc. </span><span style="color: #008000; text-decoration: underline;">http://www.db4o.com</span><span style="color: #008000;"> </span><span style="color: #008000;">*/</span></span><span style="color: #000000;">
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/></span><span style="color: #0000FF;">namespace</span><span style="color: #000000;"> Db4objects.Db4odoc.Refactoring
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_109_463_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_109_463_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_109_463_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_109_463_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_109_463_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_109_463_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_109_463_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_109_463_Open_Text').style.display='inline';"/></span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_109_463_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_109_463_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>  </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> PilotNew
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_135_461_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_135_461_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_135_461_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_135_461_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_135_461_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_135_461_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_135_461_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_135_461_Open_Text').style.display='inline';"/>  </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_135_461_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_135_461_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">string</span><span style="color: #000000;"> _identity;
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">int</span><span style="color: #000000;"> _points;
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> PilotNew(</span><span style="color: #0000FF;">string</span><span style="color: #000000;"> name, </span><span style="color: #0000FF;">int</span><span style="color: #000000;"> points) 
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_237_284_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_237_284_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_237_284_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_237_284_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_237_284_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_237_284_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_237_284_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_237_284_Open_Text').style.display='inline';"/>    </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_237_284_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_237_284_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      _identity </span><span style="color: #000000;">=</span><span style="color: #000000;"> name;
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      _points </span><span style="color: #000000;">=</span><span style="color: #000000;"> points;
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">string</span><span style="color: #000000;"> Identity
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_313_358_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_313_358_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_313_358_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_313_358_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_313_358_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_313_358_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_313_358_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_313_358_Open_Text').style.display='inline';"/>    </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_313_358_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_313_358_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">get</span><span style="color: #000000;"> 
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_326_354_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_326_354_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_326_354_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_326_354_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_326_354_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_326_354_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_326_354_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_326_354_Open_Text').style.display='inline';"/>      </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_326_354_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_326_354_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> _identity;
</span><span style="color: #008080;">20</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">21</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">22</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">23</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">override</span><span style="color: #000000;"> </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">string</span><span style="color: #000000;"> ToString() 
</span><span style="color: #008080;">24</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_399_458_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_399_458_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_399_458_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_399_458_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_399_458_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_399_458_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_399_458_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_399_458_Open_Text').style.display='inline';"/>    </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_399_458_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsPilotNew.Cs_PilotNew.Cs_1820_43_399_458_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">25</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> </span><span style="color: #0000FF;">string</span><span style="color: #000000;">.Format(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">{0}/{1}</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">,_identity,_points);
</span><span style="color: #008080;">26</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">27</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>  }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">28</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>}</span></span></div></pre></div></div>

</span>

<span name="cs_wiki_filter" csw_filters="vb">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">PilotNew.vb</span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #008000;">'</span><span style="color: #008000;"> Copyright (C) 2004 - 2007 db4objects Inc. http://www.db4o.com </span><span style="color: #008000;">
</span><span style="color: #008080;">02</span><span style="color: #008000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_65_661_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_65_661_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_65_661_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_65_661_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_65_661_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_65_661_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_65_661_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_65_661_Open_Text').style.display='inline';"/></span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_65_661_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Namespace Db4objects</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_65_661_Open_Text"><span style="color: #0000FF;">Namespace</span><span style="color: #000000;"> Db4objects.Db4odoc.Refactoring
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_117_647_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_117_647_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_117_647_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_117_647_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_117_647_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_117_647_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_117_647_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_117_647_Open_Text').style.display='inline';"/>    </span><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_117_647_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Class PilotNew</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_117_647_Open_Text"><span style="color: #0000FF;">Class</span><span style="color: #000000;"> PilotNew
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #0000FF;">Private</span><span style="color: #000000;"> _identity </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">String</span><span style="color: #000000;">
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #0000FF;">Private</span><span style="color: #000000;"> _points </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Integer</span><span style="color: #000000;">
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_219_347_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_219_347_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_219_347_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_219_347_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_219_347_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_219_347_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_219_347_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_219_347_Open_Text').style.display='inline';"/>        </span><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_219_347_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub New()</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_219_347_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> </span><span style="color: #0000FF;">New</span><span style="color: #000000;">(</span><span style="color: #0000FF;">ByVal</span><span style="color: #000000;"> name </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">String</span><span style="color: #000000;">, </span><span style="color: #0000FF;">ByVal</span><span style="color: #000000;"> points </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Integer</span><span style="color: #000000;">)
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            _identity </span><span style="color: #000000;">=</span><span style="color: #000000;"> name
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            _points </span><span style="color: #000000;">=</span><span style="color: #000000;"> points
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span><span style="color: #000000;">
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_373_492_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_373_492_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_373_492_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_373_492_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_373_492_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_373_492_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_373_492_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_373_492_Open_Text').style.display='inline';"/>        </span><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">ReadOnly</span><span style="color: #000000;"> </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_373_492_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Property Identity()</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_373_492_Open_Text"><span style="color: #0000FF;">Property</span><span style="color: #000000;"> Identity() </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">String</span><span style="color: #000000;">
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Get</span><span style="color: #000000;">
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Return</span><span style="color: #000000;"> _identity
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Get</span><span style="color: #000000;">
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Property</span></span><span style="color: #000000;">
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_519_633_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_519_633_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_519_633_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_519_633_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_519_633_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_519_633_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_519_633_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_519_633_Open_Text').style.display='inline';"/>        </span><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Overrides</span><span style="color: #000000;"> </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_519_633_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Function ToString()</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsPilotNew.Vb_PilotNew.Vb_1927_43_519_633_Open_Text"><span style="color: #0000FF;">Function</span><span style="color: #000000;"> ToString() </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">String</span><span style="color: #000000;">
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Return</span><span style="color: #000000;"> </span><span style="color: #0000FF;">String</span><span style="color: #000000;">.Format(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">{0}/{1}</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, _identity, _points)
</span><span style="color: #008080;">20</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Function</span></span><span style="color: #000000;">
</span><span style="color: #008080;">21</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    </span><span style="color: #0000FF;">End Class</span></span><span style="color: #000000;">
</span><span style="color: #008080;">22</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/></span><span style="color: #0000FF;">End Namespace</span></span></div></pre></div></div>

</span>

<p>First let's create a database and fill it with some values:</p>



<span name="cs_wiki_filter" csw_filters="cs">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">RefactoringExample.cs: <span class="fscMemberName">SetObjects</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> SetObjects()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_35_350_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_35_350_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_35_350_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_35_350_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_35_350_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_35_350_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_35_350_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_35_350_Open_Text').style.display='inline';"/>    </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_35_350_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_35_350_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      File.Delete(Db4oFileName);
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      IObjectContainer container </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(Db4oFileName);
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">try</span><span style="color: #000000;"> 
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_146_300_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_146_300_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_146_300_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_146_300_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_146_300_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_146_300_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_146_300_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_146_300_Open_Text').style.display='inline';"/>      </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_146_300_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_146_300_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        Pilot pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Pilot(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Rubens Barrichello</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        container.Set(pilot);
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Pilot(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Michael Schumacher</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        container.Set(pilot);
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;"> 
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">finally</span><span style="color: #000000;"> 
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_317_346_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_317_346_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_317_346_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_317_346_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_317_346_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_317_346_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_317_346_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_317_346_Open_Text').style.display='inline';"/>      </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_317_346_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetObjects_2108_64_317_346_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        container.Close();
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div>

</span>

<span name="cs_wiki_filter" csw_filters="vb">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">RefactoringExample.vb: <span class="fscMemberName">SetObjects</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_SetObjects_2236_64"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_SetObjects_2236_64_15_457_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_SetObjects_2236_64_15_457_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_SetObjects_2236_64_15_457_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_SetObjects_2236_64_15_457_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_SetObjects_2236_64_15_457_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_SetObjects_2236_64_15_457_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_SetObjects_2236_64_15_457_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_SetObjects_2236_64_15_457_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_SetObjects_2236_64_15_457_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub SetObjects()</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_SetObjects_2236_64_15_457_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> SetObjects()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            File.Delete(Db4oFileName)
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> container </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectContainer </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(Db4oFileName)
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> pilot </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> Pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">New</span><span style="color: #000000;"> Pilot(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Rubens Barrichello</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">)
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                container.Set(pilot)
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">New</span><span style="color: #000000;"> Pilot(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Michael Schumacher</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">)
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                container.Set(pilot)
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Finally</span><span style="color: #000000;">
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                container.Close()
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div>

</span>



<span name="cs_wiki_filter" csw_filters="cs">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">RefactoringExample.cs: <span class="fscMemberName">CheckDB</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> CheckDB()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_32_349_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_32_349_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_32_349_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_32_349_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_32_349_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_32_349_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_32_349_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_32_349_Open_Text').style.display='inline';"/>    </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_32_349_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_32_349_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      IObjectContainer container </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(Db4oFileName);
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">try</span><span style="color: #000000;"> 
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_113_299_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_113_299_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_113_299_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_113_299_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_113_299_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_113_299_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_113_299_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_113_299_Open_Text').style.display='inline';"/>      </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_113_299_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_113_299_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        IObjectSet result </span><span style="color: #000000;">=</span><span style="color: #000000;"> container.Get(</span><span style="color: #0000FF;">typeof</span><span style="color: #000000;">(Pilot));
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #0000FF;">foreach</span><span style="color: #000000;"> (</span><span style="color: #0000FF;">object</span><span style="color: #000000;"> obj </span><span style="color: #0000FF;">in</span><span style="color: #000000;"> result)
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_208_294_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_208_294_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_208_294_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_208_294_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_208_294_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_208_294_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_208_294_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_208_294_Open_Text').style.display='inline';"/>        </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_208_294_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_208_294_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          Pilot pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> (Pilot)obj;
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          System.Console.WriteLine(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Pilot=</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">+</span><span style="color: #000000;"> pilot);
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>        }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;"> 
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">finally</span><span style="color: #000000;"> 
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_316_345_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_316_345_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_316_345_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_316_345_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_316_345_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_316_345_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_316_345_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_316_345_Open_Text').style.display='inline';"/>      </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_316_345_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_CheckDB_2368_61_316_345_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        container.Close();
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div>

</span>

<span name="cs_wiki_filter" csw_filters="vb">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">RefactoringExample.vb: <span class="fscMemberName">CheckDB</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_CheckDB_2493_61"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_CheckDB_2493_61_15_517_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_CheckDB_2493_61_15_517_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_CheckDB_2493_61_15_517_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_CheckDB_2493_61_15_517_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_CheckDB_2493_61_15_517_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_CheckDB_2493_61_15_517_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_CheckDB_2493_61_15_517_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_CheckDB_2493_61_15_517_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_CheckDB_2493_61_15_517_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub CheckDB()</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_CheckDB_2493_61_15_517_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> CheckDB()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> container </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectContainer </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(Db4oFileName)
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> result </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectSet </span><span style="color: #000000;">=</span><span style="color: #000000;"> container.Get(</span><span style="color: #0000FF;">GetType</span><span style="color: #000000;">(Pilot))
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> obj </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Object</span><span style="color: #000000;">
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">For</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Each</span><span style="color: #000000;"> obj </span><span style="color: #0000FF;">In</span><span style="color: #000000;"> result
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                    </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> pilot </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> Pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">CType</span><span style="color: #000000;">(obj, Pilot)
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                    System.Console.WriteLine(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Pilot=</span><span style="color: #800000;">&quot;</span><span style="color: #000000;"> </span><span style="color: #000000;">+</span><span style="color: #000000;"> pilot.ToString())
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Next</span><span style="color: #000000;">
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Finally</span><span style="color: #000000;">
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                container.Close()
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div>

</span>

<p>We already have PilotNew class so we can go on with renaming:</p>



<span name="cs_wiki_filter" csw_filters="cs">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">RefactoringExample.cs: <span class="fscMemberName">ChangeClass</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_ChangeClass_2694_65"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> ChangeClass()
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_ChangeClass_2694_65_36_461_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_ChangeClass_2694_65_36_461_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_ChangeClass_2694_65_36_461_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_ChangeClass_2694_65_36_461_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_ChangeClass_2694_65_36_461_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_ChangeClass_2694_65_36_461_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_ChangeClass_2694_65_36_461_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_ChangeClass_2694_65_36_461_Open_Text').style.display='inline';"/>    </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_ChangeClass_2694_65_36_461_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_ChangeClass_2694_65_36_461_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            IConfiguration configuration </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.NewConfiguration();
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            configuration.ObjectClass(</span><span style="color: #0000FF;">typeof</span><span style="color: #000000;">(Pilot)).Rename(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Db4objects.Db4odoc.Refactoring.PilotNew, Db4objects.Db4odoc</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            configuration.ObjectClass(</span><span style="color: #0000FF;">typeof</span><span style="color: #000000;">(PilotNew)).ObjectField(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">_name</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">).Rename(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">_identity</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">6</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            IObjectContainer container </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(configuration, Db4oFileName);
</span><span style="color: #008080;">7</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            container.Close();
</span><span style="color: #008080;">8</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div>

</span>

<span name="cs_wiki_filter" csw_filters="vb">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">RefactoringExample.vb: <span class="fscMemberName">ChangeClass</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_ChangeClass_2823_65"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_ChangeClass_2823_65_15_479_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_ChangeClass_2823_65_15_479_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_ChangeClass_2823_65_15_479_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_ChangeClass_2823_65_15_479_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_ChangeClass_2823_65_15_479_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_ChangeClass_2823_65_15_479_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_ChangeClass_2823_65_15_479_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_ChangeClass_2823_65_15_479_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_ChangeClass_2823_65_15_479_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub ChangeClass()</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_ChangeClass_2823_65_15_479_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> ChangeClass()
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> configuration </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IConfiguration </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.NewConfiguration()
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            configuration.ObjectClass(</span><span style="color: #0000FF;">GetType</span><span style="color: #000000;">(Pilot)).Rename(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Db4objects.Db4odoc.Refactoring.PilotNew, Db4objects.Db4odoc</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">)
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            configuration.ObjectClass(</span><span style="color: #0000FF;">GetType</span><span style="color: #000000;">(PilotNew)).ObjectField(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">_name</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">).Rename(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">_identity</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">)
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> container </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectContainer </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(configuration, Db4oFileName)
</span><span style="color: #008080;">6</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            container.Close()
</span><span style="color: #008080;">7</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div>

</span>

<p>Now the data for the old Pilot class should be transferred to the new PilotNew class, and "name" field data should be stored in "identity" field.</p>

<p>To make our check more complicated let's add some data for our new class:</p>



<span name="cs_wiki_filter" csw_filters="cs">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">RefactoringExample.cs: <span class="fscMemberName">SetNewObjects</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> SetNewObjects()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_38_339_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_38_339_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_38_339_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_38_339_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_38_339_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_38_339_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_38_339_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_38_339_Open_Text').style.display='inline';"/>    </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_38_339_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_38_339_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      IObjectContainer container </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(Db4oFileName);
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">try</span><span style="color: #000000;"> 
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_119_289_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_119_289_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_119_289_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_119_289_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_119_289_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_119_289_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_119_289_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_119_289_Open_Text').style.display='inline';"/>      </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_119_289_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_119_289_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        PilotNew pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> PilotNew(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Rubens Barrichello</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">,</span><span style="color: #800080;">99</span><span style="color: #000000;">);
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        container.Set(pilot);
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> PilotNew(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Michael Schumacher</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">,</span><span style="color: #800080;">100</span><span style="color: #000000;">);
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        container.Set(pilot);
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;"> 
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">finally</span><span style="color: #000000;"> 
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_306_335_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_306_335_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_306_335_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_306_335_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_306_335_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_306_335_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_306_335_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_306_335_Open_Text').style.display='inline';"/>      </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_306_335_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_SetNewObjects_3196_67_306_335_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        container.Close();
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div>

</span>

<span name="cs_wiki_filter" csw_filters="vb">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">RefactoringExample.vb: <span class="fscMemberName">SetNewObjects</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_SetNewObjects_3327_67"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_SetNewObjects_3327_67_15_440_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_SetNewObjects_3327_67_15_440_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_SetNewObjects_3327_67_15_440_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_SetNewObjects_3327_67_15_440_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_SetNewObjects_3327_67_15_440_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_SetNewObjects_3327_67_15_440_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_SetNewObjects_3327_67_15_440_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_SetNewObjects_3327_67_15_440_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_SetNewObjects_3327_67_15_440_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub SetNewObjects()</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_SetNewObjects_3327_67_15_440_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> SetNewObjects()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> container </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectContainer </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(Db4oFileName)
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> pilot </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> PilotNew </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">New</span><span style="color: #000000;"> PilotNew(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Rubens Barrichello</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #800080;">99</span><span style="color: #000000;">)
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                container.Set(pilot)
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">New</span><span style="color: #000000;"> PilotNew(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Michael Schumacher</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #800080;">100</span><span style="color: #000000;">)
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                container.Set(pilot)
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Finally</span><span style="color: #000000;">
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                container.Close()
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div>

</span>

<p>We can check what is stored in the database now:</p>



<span name="cs_wiki_filter" csw_filters="cs">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">RefactoringExample.cs: <span class="fscMemberName">RetrievePilotNew</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> RetrievePilotNew()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_41_416_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_41_416_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_41_416_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_41_416_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_41_416_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_41_416_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_41_416_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_41_416_Open_Text').style.display='inline';"/>    </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_41_416_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_41_416_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      IObjectContainer container </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(Db4oFileName);
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">try</span><span style="color: #000000;"> 
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_122_367_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_122_367_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_122_367_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_122_367_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_122_367_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_122_367_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_122_367_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_122_367_Open_Text').style.display='inline';"/>      </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_122_367_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_122_367_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        IQuery q </span><span style="color: #000000;">=</span><span style="color: #000000;"> container.Query();
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        q.Constrain(</span><span style="color: #0000FF;">typeof</span><span style="color: #000000;">(PilotNew));
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        IObjectSet result </span><span style="color: #000000;">=</span><span style="color: #000000;"> q.Execute();
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #0000FF;">foreach</span><span style="color: #000000;"> (</span><span style="color: #0000FF;">object</span><span style="color: #000000;"> obj </span><span style="color: #0000FF;">in</span><span style="color: #000000;"> result)
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_269_361_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_269_361_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_269_361_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_269_361_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_269_361_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_269_361_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_269_361_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_269_361_Open_Text').style.display='inline';"/>        </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_269_361_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_269_361_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          PilotNew pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> (PilotNew)obj;
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          System.Console.WriteLine(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Pilot=</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">+</span><span style="color: #000000;"> pilot);
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>        }</span></span><span style="color: #000000;"> 
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">finally</span><span style="color: #000000;"> 
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_383_412_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_383_412_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_383_412_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_383_412_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_383_412_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_383_412_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_383_412_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_383_412_Open_Text').style.display='inline';"/>      </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_383_412_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringCS.ZipsRefactoringExample.Cs_RefactoringExample.Cs_RetrievePilotNew_3521_70_383_412_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        container.Close();
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div>

</span>

<span name="cs_wiki_filter" csw_filters="vb">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">RefactoringExample.vb: <span class="fscMemberName">RetrievePilotNew</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_RetrievePilotNew_3655_70"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_RetrievePilotNew_3655_70_15_613_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_RetrievePilotNew_3655_70_15_613_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_RetrievePilotNew_3655_70_15_613_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_RetrievePilotNew_3655_70_15_613_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_RetrievePilotNew_3655_70_15_613_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_RetrievePilotNew_3655_70_15_613_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_RetrievePilotNew_3655_70_15_613_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_RetrievePilotNew_3655_70_15_613_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_RetrievePilotNew_3655_70_15_613_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub RetrievePilotNew()</span><span id="ResourcesReferenceImplementation_StrategiesRefactoring_And_Schema_EvolutionrefactoringVB.ZipsRefactoringExample.Vb_RefactoringExample.Vb_RetrievePilotNew_3655_70_15_613_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> RetrievePilotNew()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> container </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectContainer </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(Db4oFileName)
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> q </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IQuery </span><span style="color: #000000;">=</span><span style="color: #000000;"> container.Query()
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                q.Constrain(</span><span style="color: #0000FF;">GetType</span><span style="color: #000000;">(PilotNew))
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> result </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectSet </span><span style="color: #000000;">=</span><span style="color: #000000;"> q.Execute()
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> obj </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Object</span><span style="color: #000000;">
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">For</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Each</span><span style="color: #000000;"> obj </span><span style="color: #0000FF;">In</span><span style="color: #000000;"> result
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                    </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> pilot </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> PilotNew </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">CType</span><span style="color: #000000;">(obj, PilotNew)
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                    System.Console.WriteLine(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Pilot=</span><span style="color: #800000;">&quot;</span><span style="color: #000000;"> </span><span style="color: #000000;">+</span><span style="color: #000000;"> pilot.ToString())
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Next</span><span style="color: #000000;">
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Finally</span><span style="color: #000000;">
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                container.Close()
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div>

</span>

<p>There is one thing to remember. The rename feature is intended to rename a class from one name to the other. Internally this will rename the meta-information. If you will try to rename class to the name that is already stored in the database, the renaming will fail, because the name is reserved. In our example it will happen if setNewObjects method will be called before changeClass.
</p></div>
    </div>
    <div id="footer">
					This revision (11) was last Modified 2008-03-09T06:40:25 by Tetyana.
				</div>
  </body>
</html>
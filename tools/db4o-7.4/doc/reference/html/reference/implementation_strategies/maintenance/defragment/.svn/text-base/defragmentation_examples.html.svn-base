<html>
  <head>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Defragmentation Examples</title>
    <link rel="stylesheet" type="text/css" href="../../../../style.css">
  </head>
  <body>
    <div class="CommonContent">
      <div class="CommonContentArea">
        <h1>Defragmentation Examples</h1><script>
//We attach this function to a browser object as a variable so that if multiple of these blocks are
//present on the same page, then they will simply over-write eachother with the same function instead
//of generating a naming collision.
window.WikiCodeFormattingCopyToClipboard = function copyToClipboard(sID){
	var sContent = document.getElementById(sID).innerText;
	if( window.clipboardData && clipboardData.setData )
	{
		clipboardData.setData("Text", sContent);
	}
	else
	{
		alert("You must enable javascript access to your clipboard for this feature to work. Please referr to your browser documentation or Google search for instructions.");
	}
}
</script>

<p>The simplest defragmentation can look like this:</p>



<span name="cs_wiki_filter" csw_filters="cs">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">DefragmentExample.cs: <span class="fscMemberName">SimplestDefragment</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> SimplestDefragment()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_48_262_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_48_262_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_48_262_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_48_262_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_48_262_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_48_262_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_48_262_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_48_262_Open_Text').style.display='inline';"/>        </span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_48_262_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_48_262_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">try</span><span style="color: #000000;">
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_78_137_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_78_137_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_78_137_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_78_137_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_78_137_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_78_137_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_78_137_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_78_137_Open_Text').style.display='inline';"/>            </span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_78_137_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_78_137_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                Defragment.Defrag(DB_FILE);
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>            }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">catch</span><span style="color: #000000;"> (Exception ex)
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_183_252_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_183_252_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_183_252_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_183_252_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_183_252_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_183_252_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_183_252_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_183_252_Open_Text').style.display='inline';"/>            </span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_183_252_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_SimplestDefragment_116_75_183_252_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                System.Console.WriteLine(ex.Message);
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>            }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        }</span></span></div></pre></div></div>

</span>

<span name="cs_wiki_filter" csw_filters="vb">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">DefragmentExample.vb: <span class="fscMemberName">SimplestDefragment</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_SimplestDefragment_255_75"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_SimplestDefragment_255_75_14_220_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_SimplestDefragment_255_75_14_220_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_SimplestDefragment_255_75_14_220_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_SimplestDefragment_255_75_14_220_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_SimplestDefragment_255_75_14_220_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_SimplestDefragment_255_75_14_220_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_SimplestDefragment_255_75_14_220_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_SimplestDefragment_255_75_14_220_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_SimplestDefragment_255_75_14_220_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub SimplestDefragment()</span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_SimplestDefragment_255_75_14_220_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> SimplestDefragment()
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                Defragment.Defrag(DB_FILE)
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Catch</span><span style="color: #000000;"> ex </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> Exception
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                System.Console.WriteLine(ex.Message)
</span><span style="color: #008080;">6</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">7</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div>

</span>



<p>The following example shows how to implement defragmentation
listener:</p>



<span name="cs_wiki_filter" csw_filters="cs">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">DefragmentExample.cs: <span class="fscMemberName">DefragmentWithListener</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> DefragmentWithListener()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_52_373_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_52_373_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_52_373_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_52_373_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_52_373_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_52_373_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_52_373_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_52_373_Open_Text').style.display='inline';"/>        </span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_52_373_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_52_373_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            DefragmentConfig config </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> DefragmentConfig(DB_FILE, BACKUP_FILE);
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">try</span><span style="color: #000000;">
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_164_248_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_164_248_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_164_248_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_164_248_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_164_248_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_164_248_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_164_248_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_164_248_Open_Text').style.display='inline';"/>            </span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_164_248_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_164_248_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                Defragment.Defrag(config, </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> DefragmentListener());
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>            }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">catch</span><span style="color: #000000;"> (Exception ex)
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_294_363_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_294_363_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_294_363_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_294_363_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_294_363_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_294_363_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_294_363_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_294_363_Open_Text').style.display='inline';"/>            </span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_294_363_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentWithListener_484_79_294_363_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                System.Console.WriteLine(ex.Message);
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>            }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        }</span></span></div></pre></div></div><div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">DefragmentExample.cs: <span class="fscMemberName">DefragmentListener</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_563_71"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> DefragmentListener : IDefragmentListener
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_563_71_58_247_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_563_71_58_247_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_563_71_58_247_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_563_71_58_247_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_563_71_58_247_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_563_71_58_247_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_563_71_58_247_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_563_71_58_247_Open_Text').style.display='inline';"/>    </span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_563_71_58_247_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_563_71_58_247_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> IDefragmentListener.NotifyDefragmentInfo(DefragmentInfo info)
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_563_71_143_241_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_563_71_143_241_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_563_71_143_241_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_563_71_143_241_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_563_71_143_241_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_563_71_143_241_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_563_71_143_241_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_563_71_143_241_Open_Text').style.display='inline';"/>        </span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_563_71_143_241_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_563_71_143_241_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">throw</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> System.Exception(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">The method or operation is not implemented.</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">6</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>        }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">7</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div> <br></p>

</span>

<span name="cs_wiki_filter" csw_filters="vb">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">DefragmentExample.vb: <span class="fscMemberName">DefragmentWithListener</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentWithListener_707_79"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentWithListener_707_79_14_335_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentWithListener_707_79_14_335_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentWithListener_707_79_14_335_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentWithListener_707_79_14_335_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentWithListener_707_79_14_335_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentWithListener_707_79_14_335_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentWithListener_707_79_14_335_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentWithListener_707_79_14_335_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentWithListener_707_79_14_335_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub DefragmentWithListener()</span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentWithListener_707_79_14_335_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> DefragmentWithListener()
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> config </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> DefragmentConfig </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">New</span><span style="color: #000000;"> DefragmentConfig(DB_FILE, BACKUP_FILE)
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                Defragment.Defrag(config, </span><span style="color: #0000FF;">New</span><span style="color: #000000;"> DefragmentListener)
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Catch</span><span style="color: #000000;"> ex </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> Exception
</span><span style="color: #008080;">6</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                System.Console.WriteLine(ex.Message)
</span><span style="color: #008080;">7</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">8</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div><div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">DefragmentExample.vb: <span class="fscMemberName">DefragmentListener</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_786_71"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_786_71_7_302_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_786_71_7_302_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_786_71_7_302_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_786_71_7_302_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_786_71_7_302_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_786_71_7_302_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_786_71_7_302_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_786_71_7_302_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_786_71_7_302_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Class DefragmentListener</span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_786_71_7_302_Open_Text"><span style="color: #0000FF;">Class</span><span style="color: #000000;"> DefragmentListener
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #0000FF;">Implements</span><span style="color: #000000;"> IDefragmentListener
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_786_71_80_288_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_786_71_80_288_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_786_71_80_288_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_786_71_80_288_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_786_71_80_288_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_786_71_80_288_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_786_71_80_288_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_786_71_80_288_Open_Text').style.display='inline';"/>        </span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_786_71_80_288_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub NotifyDefragmentInfo()</span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_786_71_80_288_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> NotifyDefragmentInfo(</span><span style="color: #0000FF;">ByVal</span><span style="color: #000000;"> info </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> DefragmentInfo) </span><span style="color: #0000FF;">Implements</span><span style="color: #000000;"> IDefragmentListener.NotifyDefragmentInfo
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Throw</span><span style="color: #000000;"> </span><span style="color: #0000FF;">New</span><span style="color: #000000;"> System.Exception(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">The method or operation is not implemented.</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">)
</span><span style="color: #008080;">6</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span><span style="color: #000000;">
</span><span style="color: #008080;">7</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    </span><span style="color: #0000FF;">End Class</span></span></div></pre></div></div> <br></p>

</span>



<p>The following example will run defragment using
TreeIDMapping and commit frequency of 1 commit per 5000 objects. The backup
file will be deleted if already exists, only available to the classloader
classes will be left in the database (java version) and the file will be
upgraded if necessary.</p>



<span name="cs_wiki_filter" csw_filters="cs">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">DefragmentExample.cs: <span class="fscMemberName">ConfiguredDefragment</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> ConfiguredDefragment()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_50_574_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_50_574_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_50_574_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_50_574_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_50_574_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_50_574_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_50_574_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_50_574_Open_Text').style.display='inline';"/>        </span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_50_574_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_50_574_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            DefragmentConfig config </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> DefragmentConfig(DB_FILE, BACKUP_FILE , </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> TreeIDMapping());
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            config.ObjectCommitFrequency(</span><span style="color: #800080;">5000</span><span style="color: #000000;">);
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            config.Db4oConfig(Db4oFactory.CloneConfiguration());
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            config.ForceBackupDelete(</span><span style="color: #0000FF;">true</span><span style="color: #000000;">);
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            config.UpgradeFile(DB_FILE </span><span style="color: #000000;">+</span><span style="color: #000000;"> </span><span style="color: #800000;">&quot;</span><span style="color: #800000;">.upg</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">try</span><span style="color: #000000;">
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_391_449_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_391_449_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_391_449_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_391_449_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_391_449_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_391_449_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_391_449_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_391_449_Open_Text').style.display='inline';"/>            </span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_391_449_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_391_449_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                Defragment.Defrag(config);
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>            }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">catch</span><span style="color: #000000;"> (Exception ex)
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_495_564_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_495_564_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_495_564_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_495_564_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_495_564_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_495_564_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_495_564_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_495_564_Open_Text').style.display='inline';"/>            </span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_495_564_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_ConfiguredDefragment_1246_77_495_564_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                System.Console.WriteLine(ex.Message);
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>            }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        }</span></span></div></pre></div></div>

</span>

<span name="cs_wiki_filter" csw_filters="vb">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">DefragmentExample.vb: <span class="fscMemberName">ConfiguredDefragment</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_ConfiguredDefragment_1387_77"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_ConfiguredDefragment_1387_77_14_529_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_ConfiguredDefragment_1387_77_14_529_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_ConfiguredDefragment_1387_77_14_529_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_ConfiguredDefragment_1387_77_14_529_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_ConfiguredDefragment_1387_77_14_529_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_ConfiguredDefragment_1387_77_14_529_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_ConfiguredDefragment_1387_77_14_529_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_ConfiguredDefragment_1387_77_14_529_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_ConfiguredDefragment_1387_77_14_529_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub ConfiguredDefragment()</span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_ConfiguredDefragment_1387_77_14_529_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> ConfiguredDefragment()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> config </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> DefragmentConfig </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">New</span><span style="color: #000000;"> DefragmentConfig(DB_FILE, BACKUP_FILE, </span><span style="color: #0000FF;">New</span><span style="color: #000000;"> TreeIDMapping)
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            config.ObjectCommitFrequency(</span><span style="color: #800080;">5000</span><span style="color: #000000;">)
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            config.Db4oConfig(Db4oFactory.CloneConfiguration)
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            config.ForceBackupDelete(</span><span style="color: #0000FF;">True</span><span style="color: #000000;">)
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            config.UpgradeFile(DB_FILE </span><span style="color: #000000;">+</span><span style="color: #000000;"> </span><span style="color: #800000;">&quot;</span><span style="color: #800000;">.upg</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">)
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                Defragment.Defrag(config)
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Catch</span><span style="color: #000000;"> ex </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> Exception
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                System.Console.WriteLine(ex.Message)
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div>

</span></div>
    </div>
    <div id="footer">
					This revision (2) was last Modified 2007-04-01T09:49:42 by Tetyana.
				</div>
  </body>
</html>